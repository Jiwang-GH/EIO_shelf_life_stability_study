---
title: "R Notebook"
output: html_notebook
---

Load packages
```{r}
rm(list=ls())
library(tidyverse)
library(plotly)

library(scales)
theme_set(theme_pubr())
source('/ghds/groups/labdesk/jiwang/analysis/tools/functions_jw.r')
```

## to check the version of R and packages used
```{r}
sessionInfo()
```


```{r}
data <- read.csv("/ghds/groups/labdesk/jiwang/analysis/G360/PRODUCTION_RELATED/EIO_stability/EIO_realtime_stability_sample_information.csv") %>% 
  mutate(run_sample_id = as.character(Sample_ID)) %>%
  mutate(run_sample_id =  ifelse(str_detect(run_sample_id, "^\\d"), str_pad(run_sample_id, 9, pad = "0"), run_sample_id)) %>% 
  mutate(Timepoint_EIOlot = paste(Time_point, EIO_Lot, sep = " "))

data
```
Conduct analysis on LPC quant and ENC quant
```{r}
## for plotting by EIO lot and by timepoint
data_select <- data %>% 
  filter(Sample_type == "VCv2")

detach(package:plyr)
data_sum_lpc_enc <- data_select   %>% 
  group_by(Time_point) %>% 
  summarise(mean_lpc = mean(LPC_quant), median_lpc = median(LPC_quant), mean_enc = mean(EN_quant), median_enc = median(EN_quant), count_samples= length(run_sample_id))
data_sum_lpc_enc
```

Plot boxplot for LPC quant by timepoint for VCv2
```{r, fig.width=12, fig.height=9, message=FALSE}
data_select$Time_point <- factor(data_select$Time_point, levels = c("T00", "T04"))
unique(data_select$Time_point)

ggplot(data_select, aes(Time_point, y = LPC_quant)) +
  geom_boxplot(aes(colour = Time_point)) +
  geom_point(aes(colour =  Time_point)) +
  scale_color_brewer(palette="Dark2") +
  geom_text( data = data_sum_lpc_enc, aes(x = Time_point, y = median_lpc, label =  paste0("Mean:", round(mean_lpc ,2),"\n" , "Median:",  round(median_lpc,2),  "\nN: ", count_samples, sep = "")), color = "black",  size = 7) +
  labs(title = "LPC Quant By Realtime Stability Study Timepoint-VCv2", colour  = "Time_point") +
  ylab("LPC Quant (ng/ul)") +
  xlab("Time_point") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 20),
      axis.text.x = element_text(angle = 45, size = 20, hjust = 1))
```

```{r}
range(data_select$LPC_quant)

model <- aov( LPC_quant ~ Time_point, data=data_select)
summary(model)
# TukeyHSD(model, conf.level=.95)
```

Plot scatter for LPC quant by timepoint for AIO VC and NTC 
```{r, fig.width=12, fig.height=9, message=FALSE}

data_select1 <-  data %>% 
  filter(Sample_type != "VCv2")

data_select1_1 <-  data %>% 
  filter(Sample_type == "NTC")

range(data_select1_1$LPC_quant)


data_select1_2 <-  data %>% 
  filter(Sample_type == "AIO Control")

range(data_select1_2$LPC_quant)

data_select1$Time_point <- factor(data_select1$Time_point, levels = c("T00", "T04"))
unique(data_select1$Time_point)

ggplot(data_select1, aes(Time_point, y = LPC_quant)) +
  geom_point(aes(colour =  Sample_type)) +
  scale_color_manual(values = c("red", "blue")) +
  labs(title = "LPC Quant By Realtime Stability Study Timepoint-VC and NTC", colour  = "Sample Type") +
  ylab("LPC Quant (ng/ul)") +
  xlab("Time_point") +
  theme_Publication() +
theme(legend.position = 'right',
   legend.direction = 'vertical',
  axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 20, hjust = 1))
```





Conduct analysis on ENC quant for VCv2
```{r, fig.width=12, fig.height=9, message=FALSE}
data_select$Time_point <- factor(data_select$Time_point, levels = c("T00", "T04"))
unique(data_select$Time_point)

ggplot(data_select, aes(Time_point, y = EN_quant)) +
  geom_boxplot(aes(colour = Time_point)) +
  geom_point(aes(colour =  Time_point)) +
  scale_color_brewer(palette="Dark2") +
  geom_hline( yintercept = 0.35, lty = "dashed", color = "red") +
  geom_text( data = data_sum_lpc_enc, aes(x = Time_point, y = median_enc, label =  paste0("Mean:", round(mean_enc ,2),"\n" , "Median:",  round(median_enc,2),  "\nN: ", count_samples, sep = "")), color = "black",  size = 7) +
  labs(title = "EN Quant By Realtime Stability Study Timepoint-VCv2", colour  = "Time_point") +
  ylab("EN Quant (nM)") +
  xlab("Time_point") +
  theme_Publication() +
 theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 20, hjust = 1))

```


Conduct Statistical analysis on EN quant
```{r}
model <- aov( EN_quant ~ Time_point, data=data_select)
summary(model)
TukeyHSD(model, conf.level=.95)
```

Plot scattor for ENC quant by timepoint for AIO VC and NTC 
```{r, fig.width=12, fig.height=9, message=FALSE}

data_select1 <-  data %>% 
  filter(Sample_type != "VCv2")

data_select1$Time_point <- factor(data_select1$Time_point, levels = c("T00", "T04"))
unique(data_select1$Time_point)

ggplot(data_select1, aes(Time_point, y = EN_quant)) +
  geom_point(aes(colour =  Sample_type)) +
  scale_color_manual(values = c("red", "blue")) +
  geom_hline( yintercept = 0.35, lty = "dashed", color = "red") +
  labs(title = "EN Quant By Realtime Stability Study Timepoint-VC and NTC", colour  = "Sample Type") +
  ylab("EN Quant (nM)") +
  xlab("Time_point") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 20, hjust = 1))
```






load in BIP data 
```{r}
source('/ghds/groups/labdesk/jiwang/analysis/tools/functions_jw.r')

fcid_list <- c("HGC7VBGXN", "HFYJNBGXN")  
autoqc_data <- list()
for (x in 1:length(fcid_list)){
  fcid <- fcid_list[x]
  outTable <-  pull_autoqc_info(fcid)
 autoqc_data <- rbind(autoqc_data , outTable)
}

autoqc_data 
dim(autoqc_data)

autoqc_data_select <-  autoqc_data  %>%
  filter(category == "sample") %>% 
  filter(metric %in% c("sample_non_singleton_families","sample_gc_bias", "sample_contamination_pct", "sample_on_target_rate", "sample_coverage_exceptions")) %>% 
  select(runid, run_sample_id,  metric,  value) %>% 
  unique()
autoqc_data_select
  
autoqc_data_select_wide <- autoqc_data_select %>% 
  spread(metric, value)

autoqc_data_select_wide
## merge with data file
detach(package:plyr)
```


Mege data
```{r}
data_combine_wide <- full_join(data, autoqc_data_select_wide, by = "run_sample_id") 
data_combine_wide

# write.csv(data_combine_wide, file = "/ghds/groups/labdesk/jiwang/analysis/G360/PRODUCTION_RELATED/EIO_stability/EIO_Realtime_stability_seq_data.csv", quote= FALSE, sep = ",", col.names = FALSE )

data_combine_select <- data_combine_wide %>% 
  filter(Sample_type == "VCv2") %>% 
  # filter(! Sample_type %in% c("AIO Control", "NTC")) %>% 
  mutate(log_nsc = log10( sample_non_singleton_families)) 

data_combine_select


## for plotting by EIO lot and by timepoint
data_sum <-  data_combine_select %>% 
  group_by(Time_point, EIO_Lot, Timepoint_EIOlot) %>% 
  summarise(mean_nsc = mean(sample_non_singleton_families), median_nsc = median(sample_non_singleton_families), mean_en = mean(EN_quant), median_en = median(EN_quant), count_samples= length(run_sample_id))

data_sum

## for plotting by EIO lot
data_sum1 <-  data_combine_select %>% 
  group_by(EIO_Lot) %>% 
  summarise(mean_nsc = mean(sample_non_singleton_families), median_nsc = median(sample_non_singleton_families), mean_en = mean(EN_quant), median_en = median(EN_quant), count_samples= length(run_sample_id))

data_sum1

## for plotting  by timepoint only
data_sum2 <-  data_combine_select %>% 
  group_by(Time_point) %>% 
  summarise(mean_nsc = mean(sample_non_singleton_families), median_nsc = median(sample_non_singleton_families), mean_en = mean(EN_quant), median_en = median(EN_quant), count_samples= length(run_sample_id))

data_sum2

data_sum3 <-  data_combine_select %>% 
  group_by(Time_point) %>% 
  summarise(mean_nsc = mean(log_nsc), median_nsc = median(log_nsc), count_samples= length(run_sample_id))

data_sum3

data_sum4 <-  data_combine_select %>% 
  group_by(Time_point, EIO_Lot, Timepoint_EIOlot) %>% 
  summarise(mean_nsc = mean(log_nsc), median_nsc = median(log_nsc), count_samples= length(run_sample_id))

data_sum4
```


Plot boxplot for NSC facet by timepoint
```{r, fig.width=20, fig.height=9, message=FALSE}
## plot the figure out
data_combine_select$Time_point <- factor(data_combine_select$Time_point, levels = c("T00", "T04"))
unique(data_combine_select$Time_point)

ggplot(data_combine_select, aes(EIO_Lot, y = sample_non_singleton_families)) +
  geom_boxplot(aes(colour = EIO_Lot)) +
  geom_point(aes(colour =  EIO_Lot)) +
  scale_color_brewer(palette="Dark2") +
  facet_wrap(.~Time_point, nrow = 1, scales = 'fixed') +
  # scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
  #             labels = trans_format("log10", math_format(10^.x))) +
  geom_text( data = data_sum, aes(x = EIO_Lot, y = median_nsc, label =  paste0("Mean:", round(mean_nsc ,0),"\n" , "Med:",  median_nsc,  "\nN: ", count_samples, sep = "")), color = "black",  size = 5) +
  labs(title = "Non-singleton Coverage By Realtime Stability Study Timepoint By EIO Plate Lot", colour  = "EIO Lot") +
  ylab("Non-singleton Coverage") +
  xlab("EIO Lot") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 15, hjust = 1))


```
```{r}
model <- aov( sample_non_singleton_families ~ Timepoint_EIOlot, data=data_combine_select)
summary(model)
TukeyHSD(model, conf.level=.95)
```

Plot boxplot for log(NSC) facet by timepoint
```{r, fig.width=20, fig.height=9, message=FALSE}
## plot the figure out
data_combine_select$Time_point <- factor(data_combine_select$Time_point, levels = c("T00", "T04"))
unique(data_combine_select$Time_point)

ggplot(data_combine_select, aes(EIO_Lot, y = log_nsc)) +
  geom_boxplot(aes(colour = EIO_Lot)) +
  geom_point(aes(colour =  EIO_Lot)) +
  scale_color_brewer(palette="Dark2") +
  facet_wrap(.~Time_point, nrow = 1, scales = 'fixed') +
  # scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
  #             labels = trans_format("log10", math_format(10^.x))) +
  geom_text( data = data_sum4, aes(x = EIO_Lot, y = median_nsc, label =  paste0("Mean:", round(mean_nsc ,2),"\n" , "Med:",  round(median_nsc,2),  "\nN: ", count_samples, sep = "")), color = "black",  size = 5) +
  labs(title = "log10(NSC) By Realtime Stability Study Timepoint By EIO Plate Lot", colour  = "EIO Lot") +
  ylab("log10(NSC)") +
  xlab("EIO Lot") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 15, hjust = 1))
```

```{r}
model <- aov( log_nsc ~ Timepoint_EIOlot, data=data_combine_select)
summary(model)
TukeyHSD(model, conf.level=.95)
```


Plot boxplot for NSC by timepoint only
```{r, fig.width=15, fig.height=10, message=FALSE}

data_combine_select$Time_point <- factor(data_combine_select$Time_point, levels = c("T00", "T04"))
unique(data_combine_select$Time_point)

ggplot(data_combine_select, aes(Time_point, y = sample_non_singleton_families)) +
  geom_boxplot(aes(colour = Time_point)) +
  geom_point(aes(colour =  Time_point)) +
  scale_color_brewer(palette="Dark2") +
  geom_text( data = data_sum2, aes(x = Time_point, y = median_nsc, label =  paste0("Mean:", round(mean_nsc ,0),"\n" , "Med:",  median_nsc,  "\nN: ", count_samples, sep = "")), color = "black",  size = 5) +
  labs(title = "Non-singleton Coverage By Realtime Stability Study Timepoint", colour  = "Timepoint") +
  ylab("Non-singleton Coverage") +
  xlab("Timepoint") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 15, hjust = 1))

```

```{r}
model <- aov( sample_non_singleton_families ~ Time_point, data=data_combine_select)
summary(model)
TukeyHSD(model, conf.level=.95)
```
```{r}
t.test(sample_non_singleton_families ~ Time_point, data=data_combine_select)

```


Fit in regression line
```{r, fig.width=15, fig.height=10, message=FALSE}
# data_combine_select1 <- data_combine_select %>% 
#   mutate(Time_point1 = ifelse(Time_point == "T00", 0, ifelse(Time_point == "T04", 4,  ifelse(Time_point == "T08", 8, 12))))
# data_combine_select1

data_combine_select1 <- data_combine_select %>% 
  mutate(Time_point1 = ifelse(Time_point == "T00", 0, 4))
data_combine_select1

ggplot(data_combine_select1, aes(Time_point1, y = sample_non_singleton_families)) +
  geom_point(aes(colour =  as.character(Time_point1))) +
  scale_y_continuous( breaks = trans_breaks(identity, identity, n = 5)) +
  scale_x_continuous(breaks=c(0, 4),
        labels=c("T00", "T04")) +
  scale_color_brewer(palette="Dark2") +
  geom_smooth(method='lm', se=TRUE, fill="#69b3a2", color="black" ) +
  stat_poly_eq(formula = y ~ x,
     aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),size = 7,
     parse = TRUE) + # add a linear regression line,  equation, and R^2
  labs(title = "Non-singleton Coverage By Accelerated Stability Study Timepoint", colour  = "Timepoint") +
  ylab("Non-singleton Coverage") +
  xlab("Timepoint") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 15, hjust = 1))

```

```{r}
eio_lm = lm(sample_non_singleton_families ~ Time_point1, data=data_combine_select1)

summary(eio_lm)
```

Plot boxplot for log10(NSC) by timepoint only
```{r, fig.width=15, fig.height=10, message=FALSE}

data_combine_select$Time_point <- factor(data_combine_select$Time_point, levels = c("T00", "Td4", "Td6", "Td8", "Td10"))
unique(data_combine_select$Time_point)

ggplot(data_combine_select, aes(Time_point, y = log_nsc)) +
  geom_boxplot(aes(colour = Time_point)) +
  geom_point(aes(colour =  Time_point)) +
  scale_color_brewer(palette="Dark2") +
  geom_text( data = data_sum3, aes(x = Time_point, y = median_nsc, label =  paste0("Mean:", round(mean_nsc ,2),"\n" , "Med:",  round(median_nsc, 2),  "\nN: ", count_samples, sep = "")), color = "black",  size = 5) +
  labs(title = "log10(NSC) By Accelerated Stability Study Timepoint", colour  = "Timepoint") +
  ylab("log10(NSC)") +
  xlab("Timepoint") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 15, hjust = 1))

```

Fit in regression line for log10(NSC) 
```{r, fig.width=15, fig.height=10, message=FALSE}
data_combine_select1 <- data_combine_select %>% 
  mutate(Time_point1 = ifelse(Time_point == "T00", 0, ifelse(Time_point == "Td4", 4, ifelse(Time_point == "Td6", 6, ifelse(Time_point == "Td8", 8, 10)))))
data_combine_select1

ggplot(data_combine_select1, aes(Time_point1, y = log_nsc)) +
  geom_point(aes(colour =  as.character(Time_point1))) +
  scale_y_continuous( breaks = trans_breaks(identity, identity, n = 5)) +
  scale_x_continuous(breaks=c(0, 4, 6, 8, 10),
        labels=c("T00", "Td4", "Td6", "Td8", "Td10")) +
  scale_color_brewer(palette="Dark2") +
  geom_smooth(method='lm', se=TRUE, fill="#69b3a2", color="black" ) +
  stat_poly_eq(formula = y ~ x,
     aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),size = 7,
     parse = TRUE) + # add a linear regression line,  equation, and R^2
  labs(title = "log10(NSC) By Accelerated Stability Study Timepoint", colour  = "Timepoint") +
  ylab("log10(NSC)") +
  xlab("Timepoint") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 15, hjust = 1))

```

```{r}
model1 <- aov( log_nsc ~ Time_point, data=data_combine_select)
summary(model1)
TukeyHSD(model1, conf.level=.95)
```
```{r}
eio_lm = lm(log_nsc ~ Time_point1, data=data_combine_select1)

summary(eio_lm)
```



Fit in regression line for log10(NSC) by EIO lot for EIO Lot A
```{r, fig.width=15, fig.height=10, message=FALSE}
data_combine_select1_1 <- data_combine_select %>% 
  filter(EIO_Lot == "Lot A") %>% 
  mutate(Time_point1 = ifelse(Time_point == "T00", 0, ifelse(Time_point == "Td4", 4, ifelse(Time_point == "Td6", 6, ifelse(Time_point == "Td8", 8, 10)))))
data_combine_select1_1

ggplot(data_combine_select1_1, aes(Time_point1, y = log_nsc)) +
  geom_point(aes(colour =  as.character(Time_point1))) +
  scale_y_continuous( breaks = trans_breaks(identity, identity, n = 5)) +
  scale_x_continuous(breaks=c(0, 4, 6, 8, 10),
        labels=c("T00", "Td4", "Td6", "Td8", "Td10")) +
  scale_color_brewer(palette="Dark2") +
  geom_smooth(method='lm', se=TRUE, fill="#69b3a2", color="black" ) +
  stat_poly_eq(formula = y ~ x,
     aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),size = 7,
     parse = TRUE) + # add a linear regression line,  equation, and R^2
  labs(title = "log10(NSC) By Accelerated Stability Study Timepoint For EIO LotA", colour  = "Timepoint") +
  ylab("log10(NSC)") +
  xlab("Timepoint") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 15, hjust = 1))

```

```{r}
eio_lm = lm(log_nsc ~ Time_point1, data=data_combine_select1_1)

summary(eio_lm)

```



Fit in regression line for log10(NSC) by EIO lot for EIO Lot  B
```{r, fig.width=15, fig.height=10, message=FALSE}
data_combine_select1_2 <- data_combine_select %>% 
  filter(EIO_Lot == "Lot B") %>% 
  mutate(Time_point1 = ifelse(Time_point == "T00", 0, ifelse(Time_point == "Td4", 4, ifelse(Time_point == "Td6", 6, ifelse(Time_point == "Td8", 8, 10)))))
data_combine_select1_2

ggplot(data_combine_select1_2, aes(Time_point1, y = log_nsc)) +
  geom_point(aes(colour =  as.character(Time_point1))) +
  scale_y_continuous( breaks = trans_breaks(identity, identity, n = 5)) +
  scale_x_continuous(breaks=c(0, 4, 6, 8, 10),
        labels=c("T00", "Td4", "Td6", "Td8", "Td10")) +
  scale_color_brewer(palette="Dark2") +
  geom_smooth(method='lm', se=TRUE, fill="#69b3a2", color="black" ) +
  stat_poly_eq(formula = y ~ x,
     aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),size = 7,
     parse = TRUE) + # add a linear regression line,  equation, and R^2
  labs(title = "log10(NSC) By Accelerated Stability Study Timepoint For EIO LotB", colour  = "Timepoint") +
  ylab("log10(NSC)") +
  xlab("Timepoint") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 15, hjust = 1))

```


```{r}
eio_lm = lm(log_nsc ~ Time_point1, data=data_combine_select1_2)

summary(eio_lm)

```

```{r, fig.width=15, fig.height=10, message=FALSE}
data_combine_select1_3 <- data_combine_select %>% 
  filter(EIO_Lot == "Lot C") %>% 
  mutate(Time_point1 = ifelse(Time_point == "T00", 0, ifelse(Time_point == "Td4", 4, ifelse(Time_point == "Td6", 6, ifelse(Time_point == "Td8", 8, 10)))))
data_combine_select1

ggplot(data_combine_select1_3, aes(Time_point1, y = log_nsc)) +
  geom_point(aes(colour =  as.character(Time_point1))) +
  scale_y_continuous( breaks = trans_breaks(identity, identity, n = 5)) +
  scale_x_continuous(breaks=c(0, 4, 6, 8, 10),
        labels=c("T00", "Td4", "Td6", "Td8", "Td10")) +
  scale_color_brewer(palette="Dark2") +
  geom_smooth(method='lm', se=TRUE, fill="#69b3a2", color="black" ) +
  stat_poly_eq(formula = y ~ x,
     aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),size = 7,
     parse = TRUE) + # add a linear regression line,  equation, and R^2
  labs(title = "log10(NSC) By Accelerated Stability Study Timepoint For EIO LotC", colour  = "Timepoint") +
  ylab("log10(NSC)") +
  xlab("Timepoint") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 15, hjust = 1))

```


```{r}
eio_lm = lm(log_nsc ~ Time_point1, data=data_combine_select1_1)

summary(eio_lm)
```
Plot boxplot for NSC by EIO lot only
```{r, fig.width=15, fig.height=10, message=FALSE}
ggplot(data_combine_select, aes(EIO_Lot, y = sample_non_singleton_families)) +
  geom_boxplot(aes(colour = EIO_Lot)) +
  geom_point(aes(colour =  EIO_Lot)) +
  scale_color_brewer(palette="Dark2") +
  geom_text( data = data_sum1, aes(x = EIO_Lot, y = median_nsc, label =  paste0("Mean:", round(mean_nsc ,0),"\n" , "Med:",  median_nsc,  "\nN: ", count_samples, sep = "")), color = "black",  size = 5) +
  labs(title = "Non-singleton Coverage By Accelerated Stability Study By EIO Plate Lot", colour  = "EIO Lot") +
  ylab("Non-singleton Coverage)") +
  xlab("EIO Lot") +
  theme_Publication() +
theme(legend.position = 'right',
      legend.direction = 'vertical',
      axis.text = element_text(size = 20),
      axis.title = element_text(size = 29),
      axis.text.x = element_text(angle = 45, size = 15, hjust = 1))

```

